{% extends 'source/base.html' %}
{% block head %}
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'CSS/header-footer.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'CSS/vueRestaurant.css' %}"/>

{% endblock %}
{% block header %}
    {% include "source/header.html" %}
{% endblock %}
{% block main %}
    <div class="background-container">
        <div class="main-container column">
            <div class="title">{{ restaurant.nom }}</div>
            <div class="nav-restaurants-container flex">
                <div class="nav-restaurants flex">
                    <div class="note-restaurant flex padding-left-5">
                        <div class="flex align padding-left">
                            {% if restaurant.note != -1 %}
                                {% for i in list_etoiles_virgules %}
                                    {% if restaurant.note >= i.nombre %}
                                        <div class="star-icon">
                                            <box-icon type='solid' color="#ffb503" ; name='star'></box-icon>
                                        </div>
                                    {% else %}
                                        {% if restaurant.note >= i.nombre_virgule %}
                                            <div class="star-icon">
                                                <box-icon type='solid' color="#ffb503" name='star-half'></box-icon>
                                            </div>
                                        {% else %}
                                            <div class="star-icon">
                                                <box-icon color="#ffb503" name='star'></box-icon>
                                            </div>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                                <div class="padding-left-5 flex padding-top-3">{{ restaurant.note }}</div>
                            {% else %}
                                <div class="text">Noter ce restaurant</div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="nav-commentaire flex">
                        <div>{{ restaurant.nb_review }}</div>
                        <div class="nav-commentaire-title margin-right">Commentaire{{ avis|pluralize }} </div>
                    </div>
                    <div class="adress">{{ restaurant.adresse }}</div>
                    <div class="nav-localisation">
                        <div>{{ restaurant.ville }}</div>
                        <div>({{ restaurant.zip_code }})</div>
                    </div>
                </div>
                {% if restaurant.telephone != "" %}
                    <div class="phone-container">
                        <div class="phone-icon">
                            <div class="flex">
                                <box-icon name='phone' type='solid' color='#9c9c9c'></box-icon>
                                <div class="phone-number">{{ restaurant.telephone }}</div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
            <div class="separator"></div>
            <div class="flex overflow">
                <div class="split-image-container">
                    <div class="main-img-container">
                        <img class="img main-img" src="{{ restaurant.image_front.url }}" alt="marche pas">
                    </div>
                </div>
                <div class="split-image-container flex column multiple-img">
                    <div class="split-img-container margin-bottom flex ">
                        <div class="split-img">
                            {% for image in imgRestaurants|slice:":4" %}
                                {% if forloop.counter == 1 %}
                                    <img class="img" src="{{ image.image.url }}" alt="marche pas">
                                {% endif %}
                            {% endfor %}
                        </div>

                        <div class="split-img">
                            {% for image in imgRestaurants %}
                                {% if forloop.counter == 2 %}
                                    <img class="img top-right-radius" src="{{ image.image.url }}"
                                         alt="marche pas">
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>

                    <div class="split-img-container flex">
                        <div class="split-img">
                            {% for image in imgRestaurants %}
                                {% if forloop.counter == 3 %}
                                    <img class="img" src="{{ image.image.url }}" alt="marche pas">
                                {% endif %}
                            {% endfor %}
                        </div>
                        <div class="split-img">
                            {% for image in imgRestaurants %}
                                {% if forloop.counter == 4 %}
                                    <img class="img bottom-right-radius" src="{{ image.image.url }}"
                                         alt="marche pas">
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Mettre un avis -->
    <div class="avis-container">
        <div class="separator avis-separator"></div>
        <div class="padding-right-5">
            {% if mail %}
                {% if commentaire %}
                    <div class="title2 text-align padding-bottom">Modifier votre avis</div>
                {% else %}
                    <div class="title2 text-align padding-bottom">Ajouter un avis</div>
                {% endif %}
                <div class="center-form">
                    <form action="{% url 'addCommentaires' restaurant.pk %}" method="post">
                        {% csrf_token %}
                        <div class="note-container flex-column padding-bottom-5">
                            <div>Ajouter une note :</div>
                            <div class="radio-container">
                                <input type="radio" name="title-rating" id="rating10" value="5">
                                <label for="rating10" title="5"></label>
                                <input type="radio" name="title-rating" id="rating9" value="4.5">
                                <label for="rating9" title="4.5" class="half"></label>
                                <input type="radio" name="title-rating" id="rating8" value="4">
                                <label for="rating8" title="4"></label>
                                <input type="radio" name="title-rating" id="rating7" value="3.5">
                                <label for="rating7" title="3.5" class="half"></label>
                                <input type="radio" name="title-rating" id="rating6" value="3">
                                <label for="rating6" title="3"></label>
                                <input type="radio" name="title-rating" id="rating5" value="2.5">
                                <label for="rating5" title="2.5" class="half"></label>
                                <input type="radio" name="title-rating" id="rating4" value="2">
                                <label for="rating4" title="2"></label>
                                <input type="radio" name="title-rating" id="rating3" value="1.5">
                                <label for="rating3" title="1.5" class="half"></label>
                                <input type="radio" name="title-rating" id="rating2" value="1">
                                <label for="rating2" title="1"></label>
                                <input type="radio" name="title-rating" id="rating1" value="0.5"/>
                                <label for="rating1" title="0.5" class="half"></label>
                            </div>
                        </div>
                        <div class="flex flex-column">
                            <label class="text-align padding-bottom-5" for="comments">Commentaire (facultatif)</label>
                            <textarea class="textarea" type="text" name="comm" rows="5" cols="100"></textarea>
                            <div class="flex vertical-center justify-center text-align">
                                <button class="bouton" type="submit">Enregistrer</button>
                            </div>
                        </div>
                    </form>
                </div>
            {% endif %}
        </div>
        <div class="separator avis-separator"></div>
    </div>

    <div class="avis-container">
        <div class="avis-title-container">
            <div class="avis-title bottom-space title2" id="commentaires">Commentaire{{ avis|pluralize }} </div>
            <div class="nb-commentaire title2">({{ restaurant.nb_review }})</div>
        </div>
        <div class="separator avis-separator"></div>
    </div>

    <!-- afficher les avis -->
    <div class="comment margin-auto">
        <div class="flex margin-bottom">
            <div class="avis-border flex column ">
                <div class="card-avis flex">
                    <div class="card-user-container flex">
                        <div class="card-img-container flex ">
                            <img class="img" src="{{ avisUser.adherant_fk.profile_picture.url }}" alt="marche pas">
                        </div>
                    </div>
                    <div class="flex column">
                        <span class="avis-user-name flex">{{ avisUser.adherant_fk.prenom }}</span>
                        <div class="note-restaurant flex">
                            {% for i in list_etoiles_virgules %}
                                {% if avisUser.note >= i.nombre %}
                                    <div class="star-icon">
                                        <box-icon type='solid' color="#ffb503" ; name='star'></box-icon>
                                    </div>
                                {% else %}
                                    {% if avisUser.note >= i.nombre_virgule %}
                                        <div class="star-icon">
                                            <box-icon type='solid' color="#ffb503" name='star-half'></box-icon>
                                        </div>
                                    {% else %}
                                        <div class="star-icon">
                                            <box-icon color="#ffb503" name='star'></box-icon>
                                        </div>
                                    {% endif %}
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <span class="avis-text flex">{{ avisUser.texte }}</span>
            </div>
        </div>
        {% for element in avis %}
            <div class="flex margin-bottom">
                <div class="avis-border flex column ">
                    <div class="card-avis flex">
                        <div class="card-user-container flex">
                            <div class="card-img-container flex ">
                                <img class="img" src="{{ element.adherant_fk.profile_picture.url }}" alt="marche pas">
                            </div>
                        </div>
                        <div class="flex column">
                            <span class="avis-user-name flex">{{ element.adherant_fk.prenom }}</span>
                            <div class="note-restaurant flex">
                                {% for i in list_etoiles_virgules %}
                                    {% if element.note >= i.nombre %}
                                        <div class="star-icon">
                                            <box-icon type='solid' color="#ffb503" ; name='star'></box-icon>
                                        </div>
                                    {% else %}
                                        {% if element.note >= i.nombre_virgule %}
                                            <div class="star-icon">
                                                <box-icon type='solid' color="#ffb503" name='star-half'></box-icon>
                                            </div>
                                        {% else %}
                                            <div class="star-icon">
                                                <box-icon color="#ffb503" name='star'></box-icon>
                                            </div>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <span class="avis-text flex">{{ element.texte }}</span>
                </div>
            </div>
        {% endfor %}
    </div>
    {% if restaurant.nb_review >= 11 %}
        <div id="container-voir-plus-result"></div>
        <div class="voir-plus-container">
            <div class="voir-plus-btn"
                 hx-get="{% url 'voirPlus' restaurant.pk %}"
                 hx-trigger="click"
                 hx-target="#container-voir-plus-result"
            >voir plus
            </div>
        </div>
    {% endif %}

{% endblock %}
{% block footer %}
    {% include "source/footer.html" %}
{% endblock %}
{% block script %}
    <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
{% endblock %}
