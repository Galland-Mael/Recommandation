{% extends 'source/base.html' %}
{% load i18n %}
{% block head %}
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'CSS/header-footer.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'CSS/index.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'CSS/glider.min.css' %}"/>
{% endblock %}

{% block header %}
    {% include "source/header.html" %}
{% endblock %}

{% block main %}
    <div class="search-container">
        <form action="{% url 'searchRestau' %}" method="POST" class="post-form form">
            {% csrf_token %}
            <div class="search">
                 <div class="drop-down">
                    <select class="select" name="type" id="lang">
                        <option value="">Type</option>
                        {% for type in listType %}
                            <option value="{{ type }}">{{ type }}</option>
                        {% endfor %}
                    </select>
                </div>
                <input class="searchTerm" type="text" name="search"
                       hx-get="{% url 'search' %}"
                       hx-trigger="keyup changed delay:250ms"
                       hx-target="#search-results"
                       placeholder="{% trans 'Rechercher un restaurant' %}..."
                >
                <button type="submit" class="searchButton">
                    <i class="fa fa-search"></i>
                </button>

            </div>
        </form>
        <div class="result-container">
            <div id="search-results">

            </div>
        </div>
    </div>
    {% if recommandation %}
        <div class="glider-contain">
            <div class="best">
                <p class="title-slider text">{% trans 'Notre sélection pour vous' %}</p>
            </div>
            <div class="glider">
                {% for element in reco %}
                    <div class="card">
                        <a href="{% url 'vueRestaurant' element.pk %}">
                            <div class="img-card">
                                <img src="{{ element.image_front.url }}" alt="image du restaurant">
                            </div>
                            <div class="info-card">
                                {% block restaurant_reco %}
                                    {% include "index/restaurant_affichage.html" %}
                                {% endblock %}
                            </div>
                        </a>
                    </div>
                {% endfor %}
            </div>
            <button aria-label="Previous" class="glider-prev">«</button>
            <button aria-label="Next" class="glider-next">»</button>
            <div role="tablist" class="dots"></div>
        </div>
    {% endif %}
    {% if italian|length > 7 %}
        <div class="container">
            <div class="best margin-top">
                <p class="title text">{% trans 'Les meilleurs restaurants Italiens' %}</p>
            </div>
            <div class="grid">
                {% for element in italian %}
                    <a href="{% url 'vueRestaurant' element.pk %}" class="data-card">
                        <div class="img-card">
                            <img class="img-best" src="{{ element.image_front.url }}" alt="Image du restaurant">
                        </div>
                        {% block restaurant_by_type %}
                            {% include "index/restaurant_affichage.html" %}
                        {% endblock %}
                    </a>
                {% endfor %}
            </div>
        </div>
    {% endif %}
    {% if visites %}
        <div class="container">
            <div class="best margin-top">
                <p class="title text">{% trans 'Vous avez apprécier lors de votre dernière visite' %}</p>
            </div>
            <div class="grid">
                {% for element in visites %}
                    <a href="{% url 'vueRestaurant' element.pk %}" class="data-card">
                        <div class="img-card">
                            <img class="img-best" src="{{ element.image_front.url }}" alt="Image du restaurant">
                        </div>
                        {% block restaurant_visites %}
                            {% include "index/restaurant_affichage.html" %}
                        {% endblock %}
                    </a>
                {% endfor %}
            </div>
        </div>
    {% endif %}
    {% if restaurants_sans_note %}
        <div class="container">
            <div class="best margin-top">
                <p class="title text">{%  trans 'Soyez le premier à noter ce restaurant' %}</p>
            </div>
            <div class="grid">
                {% for element in restaurants_sans_note %}
                    <a href="{% url 'vueRestaurant' element.pk %}" class="data-card">
                        <div class="img-card">
                            <img class="img-best" src="{{ element.image_front.url }}" alt="Image du restaurant">
                        </div>
                        {% block restaurant_without_note %}
                            {% include "index/restaurant_affichage.html" %}
                        {% endblock %}
                    </a>
                {% endfor %}
            </div>
        </div>
    {% endif %}
    <div class="container">
        <div class="best margin-top">
            <p class="title text">{%  trans 'Les restaurants les plus appréciés'%}</p>
        </div>
        <div class="grid">
            {% for element in meilleurRestaurants %}
                <a href="{% url 'vueRestaurant' element.pk %}" class="data-card">
                    <div class="img-card">
                        <img class="img-best" src="{{ element.image_front.url }}" alt="Image du restaurant">
                    </div>
                    <div class="info-card">
                        {% block best_restaurants %}
                            {% include "index/restaurant_affichage.html" %}
                        {% endblock %}
                    </div>
                </a>
            {% endfor %}
        </div>
    </div>

{% endblock %}

{% block footer %}
    {% include "source/footer.html" %}
{% endblock %}

{% block script %}
    <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
    <script src="{% static 'JS/index.js' %}"></script>
    <script src="{% static 'JS/glider.min.js' %}"></script>
    <script>new Glider(document.querySelector('.glider'), {
        slidesToShow: 5,
        draggable: true,
        dots: '#dots',
        arrows: {
            prev: '.glider-prev',
            next: '.glider-next'
        }
    });
    </script>
{% endblock %}

